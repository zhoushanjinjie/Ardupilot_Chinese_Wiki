<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wiki Editing - Setting Up the Environment &mdash; Copter  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/common_theme_override.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_copter.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/./useralerts.js"></script>
        <script data-domain="ardupilot.org" defer="defer" src="https://plausible.ardupilot.org/js/script.outbound-links.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Copter
              <img src="../_static/ardupilot_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="copter-introduction.html">Copter简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-autopilots.html">选择飞控</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-GCS.html">地面站软件</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial-setup.html">首次设置</a></li>
<li class="toctree-l1"><a class="reference internal" href="flying-arducopter.html">首次飞行和调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-helicopters.html">传统直升机</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-mission-planning.html">任务规划</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-when-problems-arise.html">如果出现问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-advanced-configuration.html">高级配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-optional-hardware.html">可选硬件</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional-information.html">附加信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-user-alerts.html">用户警报</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Copter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Wiki Editing - Setting Up the Environment</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wiki-editing-setting-up-the-environment">
<span id="common-wiki-editing-setup"></span><h1>Wiki Editing - Setting Up the Environment<a class="headerlink" href="#wiki-editing-setting-up-the-environment" title="Permalink to this heading">¶</a></h1>
<p id="common-wiki-editing-guide-building-docs">Before submitting large changes to the wiki it is best to check the pages are rendered correctly including checking all images and links appear correctly.  This page explains how to “build” the wiki (i.e. convert the rst files and image files into a set of html pages) on your local machine so that you can perform these checks.</p>
<p>There are several methods to setup a local build environment:</p>
<ol class="arabic simple">
<li><p>Use the <a class="reference external" href="https://github.com/ArduPilot/ardupilot_wiki/blob/master/Vagrantfile">Vagrantfile</a> in the root of the repo to create a Linux virtual machine with all the necessary packages installed.  This is the preferred and supported method.</p></li>
<li><p>Use the <a class="reference external" href="https://github.com/ArduPilot/ardupilot_wiki/blob/master/Dockerfile">Dockerfile</a> in the root of the repo to create a Linux container with all the necessary packages installed.</p></li>
<li><p>Or simply install the required libraries on your local Linux or Windows machine, using the instructions below.</p></li>
</ol>
<section id="fork-clone-and-update-your-copy-of-the-wiki">
<h2>Fork, Clone, and Update Your Copy of the Wiki<a class="headerlink" href="#fork-clone-and-update-your-copy-of-the-wiki" title="Permalink to this heading">¶</a></h2>
<p>First, the wiki should be forked and cloned much like <a class="reference external" href="https://ardupilot.org/dev/docs/where-to-get-the-code.html#where-to-get-the-code" title="(in Dev)"><span class="xref std std-ref">developers do for the flight code</span></a>.</p>
<ol class="arabic">
<li><p>Create a <a class="reference external" href="https://github.com/join">Github account</a> if you do not have one already</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/dev/docs/git-install.html#git-install" title="(in Dev)"><span class="xref std std-ref">Install a Git Client</span></a></p></li>
<li><p><a class="reference external" href="https://ardupilot.org/dev/docs/git-fork.html#git-fork" title="(in Dev)"><span class="xref std std-ref">Fork</span></a> the <a class="reference external" href="https://github.com/ArduPilot/ardupilot_wiki">ardupilot_wiki</a> to create your own copy in GitHub (note linked instructions are for the ardupilot flight code so “ardupilot” should be replaced with “ardupilot_wiki”)</p>
<blockquote>
<div><img alt="../_images/APM-Git-Github-Fork-300x64.jpg" src="../_images/APM-Git-Github-Fork-300x64.jpg" />
</div></blockquote>
</li>
<li><p><a class="reference external" href="https://ardupilot.org/dev/docs/git-clone.html#git-clone" title="(in Dev)"><span class="xref std std-ref">Clone</span></a> your copy of ardupilot_wiki on GitHub to your local machine (note linked instructions are for the ardupilot flight code so “ardupilot” should be replaced with “ardupilot_wiki”)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/YOURID/ardupilot_wiki.git
</pre></div>
</div>
</li>
</ol>
<p>Be sure to keep your fork of the repository updated, both locally, and on GitHub both as you install and as you develop new contributions. Be sure to create a working branch locally when you start to make changes, pushing that branch up to your GitHub repo, and then making a PR (pull-request from there to the Wiki repo), in a manner similar to making <a class="reference external" href="https://ardupilot.org/dev/docs/submitting-patches-back-to-master.html#submitting-patches-back-to-master" title="(in Dev)"><span class="xref std std-ref">code PRs</span></a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>upstream<span class="w"> </span>https://github.com/ArduPilot/ardupilot_wiki.git
git<span class="w"> </span>checkout<span class="w"> </span>master
git<span class="w"> </span>fetch<span class="w"> </span>upstream
git<span class="w"> </span>rebase<span class="w"> </span>upstream/master
git<span class="w"> </span>push<span class="w"> </span>-f<span class="w"> </span>origin<span class="w"> </span>master
</pre></div>
</div>
</section>
<section id="setup-the-environment">
<h2>Setup the Environment<a class="headerlink" href="#setup-the-environment" title="Permalink to this heading">¶</a></h2>
<section id="setup-in-linux-or-wsl">
<h3>Setup in Linux (or WSL)<a class="headerlink" href="#setup-in-linux-or-wsl" title="Permalink to this heading">¶</a></h3>
<p>Run the following command from the ardupilot_wiki directory you cloned:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./Sphinxsetup.sh
</pre></div>
</div>
<p>Then jump down to “Build the wiki”.</p>
</section>
<section id="setup-in-windows">
<h3>Setup in Windows<a class="headerlink" href="#setup-in-windows" title="Permalink to this heading">¶</a></h3>
<p>Running in WSL or Cygwin is not required. The ArduPilot wiki can be built directly on Windows.</p>
<p>Ensure that the latest version of <a class="reference external" href="https://www.python.org/downloads/">Python</a> is installed and the “Add Python 3.x to PATH” option is selected during installation.</p>
<p>Run the following command from the ardupilot_wiki directory you cloned, ensuring that it is run as administrator (right click -&gt; Run as Administrator):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./Sphinxsetup.bat
</pre></div>
</div>
<p>Then jump down to “Build the wiki”.</p>
</section>
<section id="setup-with-vagrant">
<h3>Setup with Vagrant<a class="headerlink" href="#setup-with-vagrant" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Download and install <a class="reference external" href="https://www.vagrantup.com/downloads.html">Vagrant</a></p></li>
<li><p>Download and install <a class="reference external" href="https://www.virtualbox.org/wiki/Downloads">Oracle VirtualBox</a>.</p></li>
<li><p>Windows users should install an SSH client on the computer before starting vagrant. Vagrant needs  SSH client program to access the development container. We have had great success with OpenSSH packer from MLS-Software <a class="reference external" href="http://www.mls-software.com/opensshd.html">here</a></p></li>
</ol>
<p>The main steps for building the docs are:</p>
<ol class="arabic">
<li><p>Open a command prompt in the root of the ardupilot_wiki repo, and start Vagrant.  The first time this is run it may take over 30 minutes to complete.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>ardupilot_wiki
vagrant<span class="w"> </span>up
</pre></div>
</div>
</li>
<li><p>SSH into Vagrant (Windows users may need to add SSH to your PATH)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vagrant<span class="w"> </span>ssh
</pre></div>
</div>
</li>
<li><p>Navigate in the SSH shell to the /vagrant directory and start the build.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>/vagrant
python3<span class="w"> </span>update.py
</pre></div>
</div>
</li>
</ol>
</section>
<section id="setup-with-docker">
<h3>Setup with Docker<a class="headerlink" href="#setup-with-docker" title="Permalink to this heading">¶</a></h3>
<ol class="arabic">
<li><p>Download and install Docker according to their <a class="reference external" href="https://docs.docker.com/install/">official documentation</a>.</p></li>
<li><p>Open a command prompt in the root of the ardupilot_wiki repo and build the docker container for the wiki:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>ardupilot_wiki
docker<span class="w"> </span>build<span class="w"> </span>.<span class="w"> </span>-t<span class="w"> </span>ardupilot_wiki
</pre></div>
</div>
</li>
</ol>
<p>This will build a docker image with all package setup to build the wiki and name it <code class="docutils literal notranslate"><span class="pre">ardupilot_wiki</span></code>.</p>
<ol class="arabic">
<li><p>Use the container to build the wiki with a shared volume to get the build result on your computer:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span>-v<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">:/ardupilot_wiki&quot;</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span><span class="s2">:</span><span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>ardupilot_wiki<span class="w"> </span>python3<span class="w"> </span>update.py
</pre></div>
</div>
</li>
</ol>
<p>That will build the wiki with the <code class="docutils literal notranslate"><span class="pre">update.py</span></code> similarly as in <a class="reference internal" href="#build-the-wiki">Build the Wiki</a>. The <cite>-v</cite> is used to share the content of the current directory, that holds all the documentation, to the container. The <cite>-u</cite> is used to make docker use the same permission as your current user. With those two commands, the resulting build is accessible as in <a class="reference internal" href="#check-the-results">Check the Results</a></p>
</section>
</section>
<section id="build-the-wiki">
<h2>Build the Wiki<a class="headerlink" href="#build-the-wiki" title="Permalink to this heading">¶</a></h2>
<p>As shown in the last step of the vagrant instructions above, use update.py to build some or all of the wiki.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>update.py<span class="w"> </span><span class="o">(</span>to<span class="w"> </span>build<span class="w"> </span>all<span class="w"> </span>wikis<span class="o">)</span>
python3<span class="w"> </span>update.py<span class="w"> </span>--site<span class="w"> </span>copter<span class="w">  </span><span class="o">(</span>to<span class="w"> </span>build<span class="w"> </span>just<span class="w"> </span>the<span class="w"> </span>copter<span class="w"> </span>wiki<span class="o">)</span>
python3<span class="w"> </span>update.py<span class="w"> </span>--site<span class="w"> </span>plane<span class="w">   </span><span class="o">(</span>to<span class="w"> </span>build<span class="w"> </span>just<span class="w"> </span>the<span class="w"> </span>plane<span class="w"> </span>wiki<span class="o">)</span>
python3<span class="w"> </span>update.py<span class="w"> </span>--site<span class="w"> </span>rover<span class="w">   </span><span class="o">(</span>to<span class="w"> </span>build<span class="w"> </span>just<span class="w"> </span>the<span class="w"> </span>rover<span class="w"> </span>wiki<span class="o">)</span>
python3<span class="w"> </span>update.py<span class="w"> </span>--site<span class="w"> </span>dev<span class="w">     </span><span class="o">(</span>to<span class="w"> </span>build<span class="w"> </span>just<span class="w"> </span>this<span class="w"> </span>developer<span class="w"> </span>wiki<span class="o">)</span>
</pre></div>
</div>
<p>The update.py script will copy the common files into each wiki subdirectory and then build each wiki.</p>
<p>After the build, the wiki files will be copied to <code class="docutils literal notranslate"><span class="pre">--destdir</span></code>. By default, in Linux this is <code class="docutils literal notranslate"><span class="pre">/var/sites/wiki/web</span></code> and in Windows it is <code class="docutils literal notranslate"><span class="pre">..\wiki</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The script will show the build output of each of the wikis. This should be inspected for warnings and errors.</p>
</div>
<p>Details on the building and infrastructure of the wiki can be found <a class="reference internal" href="common-wiki-editing-infra-overview.html#common-wiki-editing-infra-overview"><span class="std std-ref">here</span></a>.</p>
<section id="check-the-results">
<h3>Check the Results<a class="headerlink" href="#check-the-results" title="Permalink to this heading">¶</a></h3>
<p>With your favourite web browser, open the locally built wiki which should be near where the ardupilot_wiki repo was cloned to</p>
<ul class="simple">
<li><p>For Copter look for <code class="docutils literal notranslate"><span class="pre">ardupilot_wiki/copter/build/html/index.html</span></code></p></li>
<li><p>For Plane look for <code class="docutils literal notranslate"><span class="pre">ardupilot_wiki/plane/build/html/index.html</span></code></p></li>
<li><p>For Rover look for <code class="docutils literal notranslate"><span class="pre">ardupilot_wiki/rover/build/html/index.html</span></code></p></li>
<li><p>For Developer look for <code class="docutils literal notranslate"><span class="pre">ardupilot_wiki/dev/build/html/index.html</span></code></p></li>
</ul>
</section>
<section id="build-options">
<h3>Build options<a class="headerlink" href="#build-options" title="Permalink to this heading">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usage: update.py [-h] [--site SITE] [--clean] [--cached-parameter-files] [--parallel PARALLEL] [--destdir DESTDIR] [--enablebackups] [--backupdestdir BACKUPDESTDIR] [--paramversioning] [--verbose] [--fast]

Copy Common Files as needed, stripping out non-relevant wiki content

optional arguments:
-h, --help            show this help message and exit
--site SITE           If you just want to copy to one site, you can do this. Otherwise will be copied.
--clean               Does a very clean build - resets git to master head (and TBD cleans up any duplicates in the output).
--cached-parameter-files
                        Do not re-download parameter files
--parallel PARALLEL   limit parallel builds, -1 for unlimited
--destdir DESTDIR     Destination directory for compiled docs
--enablebackups       Enable several backups up to const N_BACKUPS_RETAIN in --backupdestdir folder
--backupdestdir BACKUPDESTDIR
                        Destination directory for compiled docs
--paramversioning     Build multiple parameters pages for each vehicle based on its firmware repo.
--verbose             show debugging output
--fast                Incremental build using already downloaded parameters, log messages, and video thumbnails rather than cleaning before build.
</pre></div>
</div>
<p>Most of the build options will only be used on the server that builds the wiki. The options that editors are most likely to find useful are <cite>–site SITE</cite> and <cite>–fast</cite>. <cite>–site SITE</cite> allows for building a single wiki rather than building all of the wikis. This is a huge bump in speed already, but sometimes checking changes across multiple wikis is necessary. The <cite>–fast</cite> option skips downloading data needed for vehicle parameters, log messages, and video thumbnails. This can be helpful when doing small formatting changes or when new parameters/log messages are not needed for the build. Newly added video thumbnails will be downloaded and cached for the next build with <cite>–fast</cite> enabled.</p>
</section>
</section>
<section id="rst-editing-previewing">
<h2>RST editing/previewing<a class="headerlink" href="#rst-editing-previewing" title="Permalink to this heading">¶</a></h2>
<p>The tools described in this section can make it easier to edit RST files and reduce the time required to preview changes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The RST rendering tools can be useful for rapidly previewing small changes in the documentation. Rendering will not be perfect because the tools are designed for generic reStructuredText (they and are not “Sphinx-aware). We therefore recommend that you build with Sphinx to do a final review before you make a documentation pull request.</p>
</div>
<section id="rst-rendering-on-windows">
<h3>RST rendering on Windows<a class="headerlink" href="#rst-rendering-on-windows" title="Permalink to this heading">¶</a></h3>
<p>A combination of two Windows tools can help you preview your modifications:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/steenhulthin/reStructuredText_NPP">Notepad++ plugin for RST files</a></p></li>
<li><p><a class="reference external" href="https://mg.pov.lt/restview/">restview (on-the-fly renderer for RST files)</a></p></li>
<li><p><a class="reference external" href="https://www.jetbrains.com/pycharm/">PyCharm</a></p></li>
</ul>
<p>The Notepad++ plugin helps you with code completion and syntax highlighting during modification.
Restview renders RST files on-the-fly, i.e. each modification on the RST file can be immediately
visualized in your web browser.</p>
<p>The installation of the Notepad++ plugin is clearly explained on the plugin’s website (see above).</p>
<p>Restview can be installed with:</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>python3 -m pip install restview
</pre></div>
</div>
<p>The restview executable will be installed in the <strong>Scripts</strong> folder of the Python main folder.
Restview will start the on-the-fly HTML rendering and open a tab page in your preferred web browser.</p>
<p>Example:</p>
<p>If you are in the root folder of your local Wiki repository:</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">start</span> \python-folder\Scripts\restview common\source\docs\common-wiki_editing_guide.rst
</pre></div>
</div>
</section>
<section id="rst-rendering-on-linux">
<h3>RST rendering on Linux<a class="headerlink" href="#rst-rendering-on-linux" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/retext-project/retext">ReText</a> is a Linux tool that provides syntax highlighting and basic on-the-fly rendering in a single application.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the tool is Python based, don’t try it on Windows as it is very prone to crashes (this is also stated by the website).</p>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://www.jetbrains.com/pycharm/">PyCharm</a></p></li>
</ul>
<p>[copywiki destination=”copter,plane,rover,planner,planner2,antennatracker,dev,ardupilot,mavproxy”]</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ArduPilot Dev Team.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>