<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ModalAI VOXL &mdash; Copter  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/common_theme_override.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_copter.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/./useralerts.js"></script>
        <script data-domain="ardupilot.org" defer="defer" src="https://plausible.ardupilot.org/js/script.outbound-links.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Nooploop for Non-GPS Navigation" href="common-nooploop.html" />
    <link rel="prev" title="Marvelmind for Non-GPS navigation" href="common-marvelmind.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Copter
              <img src="../_static/ardupilot_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="copter-introduction.html">Copter简介</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introducing Copter</a></li>
<li class="toctree-l2"><a class="reference internal" href="what-is-a-multicopter-and-how-does-it-work.html">How Multicopters Work</a></li>
<li class="toctree-l2"><a class="reference internal" href="copter-use-case-overview.html">Use-Case Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="copter-flight-features.html">Flight Features</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="common-geofencing-landing-page.html">[site wiki=”plane”]</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-geofencing-landing-page.html#geofencing">GeoFencing</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-geofencing-landing-page.html#detailed-information">Detailed Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-object-avoidance-landing-page.html">Object Avoidance</a></li>
<li class="toctree-l3"><a class="reference internal" href="terrain-following.html">Terrain Following (in Auto, Guided, etc)</a></li>
<li class="toctree-l3"><a class="reference internal" href="terrain-following-manual-modes.html">Surface Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="motor-thrust-scaling.html">Motor Thrust Scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-imu-notch-filtering.html">Notch Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-moving-vehicle-initialization.html">Moving Vehicle Initialization</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="common-non-gps-navigation-landing-page.html">Non-GPS Navigation</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="common-vio-tracking-camera.html">Intel RealSense T265</a></li>
<li class="toctree-l4"><a class="reference internal" href="common-marvelmind.html">MarvelMind Beacons</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">ModalAI VOXL</a></li>
<li class="toctree-l4"><a class="reference internal" href="common-nooploop.html">Nooploop Beacons</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="weathervaning.html">Weathervaning and Wind Hold</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="choosing-a-frame.html">Choosing a MultiCopter Frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="what-you-need.html">Building Your Own Frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="safety-multicopter.html">MultiCopter Safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference-frames.html">Reference Frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-rtf.html">Ready to Fly vehicles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="common-autopilots.html">选择飞控</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-GCS.html">地面站软件</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial-setup.html">首次设置</a></li>
<li class="toctree-l1"><a class="reference internal" href="flying-arducopter.html">首次飞行和调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-helicopters.html">传统直升机</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-mission-planning.html">任务规划</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-when-problems-arise.html">如果出现问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-advanced-configuration.html">高级配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-optional-hardware.html">可选硬件</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional-information.html">附加信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-user-alerts.html">用户警报</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Copter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="copter-introduction.html">Copter Introduction</a></li>
          <li class="breadcrumb-item"><a href="copter-flight-features.html">Flight Features</a></li>
          <li class="breadcrumb-item"><a href="common-non-gps-navigation-landing-page.html">Non-GPS Navigation</a></li>
      <li class="breadcrumb-item active">ModalAI VOXL</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="modalai-voxl">
<span id="common-modalai-voxl"></span><h1>ModalAI VOXL<a class="headerlink" href="#modalai-voxl" title="Permalink to this heading">¶</a></h1>
<p>[copywiki destination=”copter,rover,blimp”]</p>
<a class="reference internal image-reference" href="../_images/modalai-voxl.png"><img alt="../_images/modalai-voxl.png" src="../_images/modalai-voxl.png" style="width: 450px;" /></a>
<p>This article explains how to setup a <a class="reference external" href="https://www.modalai.com/en-jp/pages/voxl-cam-perception-engine">ModalAI VOXL-CAM</a> for use with ArduPilot as a substitude for a GPS allowing position control modes like Loiter, PosHold, RTL, Auto to work.</p>
<p>Other versions of the VOXL cameras should also work except for the VOXL2 which is not yet supported.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>VOXL camera support is available in ArduPilot 4.3 (and higher).</p>
</div>
<section id="what-to-buy">
<h2>What to Buy<a class="headerlink" href="#what-to-buy" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.modalai.com/products/voxl-cam?variant=39593458827315">VOXL CAM + TOF Dev Kit</a></p></li>
<li><p><a class="reference external" href="https://www.modalai.com/collections/accessories/products/voxl-to-flight-controller-telemetry-cable">Flight Controller Telemetry Cable</a></p></li>
<li><p>Optionally an 8GB or larger SD Card</p></li>
</ul>
</section>
<section id="hardware-setup">
<h2>Hardware Setup<a class="headerlink" href="#hardware-setup" title="Permalink to this heading">¶</a></h2>
<a class="reference external image-reference" href="../_images/modalai-voxl-autpilot.png"><img alt="../_images/modalai-voxl-autpilot.png" src="../_images/modalai-voxl-autpilot.png" style="width: 500px;" /></a>
<ul class="simple">
<li><p>Connect the VOXL camera to the autopilot as shown above.  In these instructions the autopilot’s Telem2 port is used.</p></li>
<li><p>Mount the VOXL camera on the front of the vehicle oriented so that the wifi antennas extend from the bottom of the camera</p></li>
</ul>
</section>
<section id="voxl-camera-configuration">
<h2>VOXL Camera Configuration<a class="headerlink" href="#voxl-camera-configuration" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.modalai.com/voxl-cam-user-guide-core/">ModalAI’s VOX-CAM setup instructions here</a></p>
<p>The minimum steps to get the camera working include</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.modalai.com/setup-adb/">Setup adb</a> on an Ubuntu workstation</p></li>
<li><p>Connect the camera to the Ubuntu workstation, start and adb shell and <a class="reference external" href="https://docs.modalai.com/voxl-vision-px4-installation/">run voxl-configure-vision-px4</a> (Note: you may simply press &lt;enter&gt; when asked for an IP address)</p></li>
<li><p>run “systemctl enable voxl-mavlink-server” to configure the mavlink server to start automatically</p></li>
<li><p>Optionally <a class="reference external" href="https://docs.modalai.com/voxl-cam-user-guide-core/#view-visual-inertial-odometry-data">run “systemctl status voxl-vision-px4”</a> to check if VOXL is producing good position estimates</p></li>
</ul>
</section>
<section id="autopilot-configuration">
<h2>Autopilot Configuration<a class="headerlink" href="#autopilot-configuration" title="Permalink to this heading">¶</a></h2>
<p>Connect to the autopilot with a ground station (i.e. Mission Planner) and check that the following parameters are set:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#serial2-protocol" title="(in Rover)"><span class="xref std std-ref">SERIAL2_PROTOCOL</span></a> = 2 (MAVLink2).  Note this assumes the camera is connected to the autopilot’s “Telem2” port.</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#serial2-baud" title="(in Rover)"><span class="xref std std-ref">SERIAL2_BAUD</span></a> = 921 (921600 baud)</p></li>
<li><p>Optionally set <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#serial2-options" title="(in Rover)"><span class="xref std std-ref">SERIAL2_OPTIONS</span></a> = 1024 (Don’t forward mavlink to/from) to disable the camera’s odometry messages from being sent to the GCS</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#viso-type" title="(in Rover)"><span class="xref std std-ref">VISO_TYPE</span></a> = 3 (VOXL)</p></li>
<li><p>Set <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#viso-pos-x" title="(in Rover)"><span class="xref std std-ref">VISO_POS_X</span></a>, <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#viso-pos-y" title="(in Rover)"><span class="xref std std-ref">VISO_POS_Y</span></a>, <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#viso-pos-z" title="(in Rover)"><span class="xref std std-ref">VISO_POS_Z</span></a> to the camera’s position on the drone relative to the center-of-gravity.  See <a class="reference internal" href="common-sensor-offset-compensation.html#common-sensor-offset-compensation"><span class="std std-ref">sensor position offset compensation</span></a> for more details</p></li>
</ul>
<p>If only the VOXL camera will be used for position estimation and heading (e.g. No GPS):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-posxy" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_POSXY</span></a> = 6 (ExternalNav)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-velxy" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_VELXY</span></a> = 6 (ExternalNav)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-posz" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_POSZ</span></a> = 6 (ExternalNav)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-velz" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_VELZ</span></a> = 6 (ExternalNav)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-yaw" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_YAW</span></a> = 6 (ExternalNav)</p></li>
</ul>
<p>After the parameters are modified, reboot the autopilot.  Connect with the ground station and (if using Mission Planner) right-mouse-button-click on the map, select “Set Home Here”, “Set EKF Origin Here” to tell ArduPilot where the vehicle is and it should instantly appear on the map.</p>
<p>For indoor/outdoor transitions (e.g. VOXL camera indoors, GPS+Compass outdoors):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-posxy" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_POSXY</span></a> = 3 (GPS)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-velxy" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_VELXY</span></a> = 3 (GPS)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-posz" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_POSZ</span></a> = 1 (Baro)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-velz" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_VELZ</span></a> = 0 (None)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src1-yaw" title="(in Rover)"><span class="xref std std-ref">EK3_SRC1_YAW</span></a> = 1 (Compass)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src2-posxy" title="(in Rover)"><span class="xref std std-ref">EK3_SRC2_POSXY</span></a> = 6 (ExternalNav)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src2-velxy" title="(in Rover)"><span class="xref std std-ref">EK3_SRC2_VELXY</span></a> = 6 (ExternalNav)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src2-posz" title="(in Rover)"><span class="xref std std-ref">EK3_SRC2_POSZ</span></a> = 6 (ExternalNav)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src2-velz" title="(in Rover)"><span class="xref std std-ref">EK3_SRC2_VELZ</span></a> = 6 (ExternalNav)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ek3-src2-yaw" title="(in Rover)"><span class="xref std std-ref">EK3_SRC2_YAW</span></a> = 6 (ExternalNav)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#rc6-option" title="(in Rover)"><span class="xref std std-ref">RC6_OPTION</span></a> = 90 (EKF Pos Source) to allow the pilot to use channel 6 to switch between Source1 (e.g. GPS+Compass) and Source2 (e.g. VOXL camera).  The switch’s low position is Source1 (GPS+Compass), middle position is Source2 (e.g. VOXL), and high position is Source3 (e.g. None) which will lead to the EKF losing its position estimate and triggering an EKF failsafe.  To avoid pilot error triggering an EKF failsafe you may wish to copy EK3_SRC1_xxx or EK2_SRC2_xxx to EK3_SRC3_xx.</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#rc7-option" title="(in Rover)"><span class="xref std std-ref">RC7_OPTION</span></a> = 80 (Viso Align) to allow the pilot to use channel 7 to re-align the camera’s yaw with the AHRS/EKF yaw before flight.  Re-aligning yaw before takeoff is a good idea or loss of position control (aka “toilet bowling”) may occur.</p></li>
</ul>
<p>After the parameters are modified, reboot the autopilot.</p>
<p>More details on <a class="reference internal" href="common-non-gps-to-gps.html#common-non-gps-to-gps"><span class="std std-ref">GPS/Non-GPS Transitions can be found here</span></a></p>
</section>
<section id="videos">
<h2>Videos<a class="headerlink" href="#videos" title="Permalink to this heading">¶</a></h2>
<div class="video_wrapper" style="padding-bottom: 56.250000%; padding-top: 30px; position: relative; width: 100%">
<iframe allowfullscreen="true" src="https://www.youtube.com/embed/CikqIRzXlRc" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%">
</iframe></div></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="common-marvelmind.html" class="btn btn-neutral float-left" title="Marvelmind for Non-GPS navigation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="common-nooploop.html" class="btn btn-neutral float-right" title="Nooploop for Non-GPS Navigation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ArduPilot Dev Team.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>