<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>[copywiki destination=”plane,copter,rover,blimp”] &mdash; Copter  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/common_theme_override.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_copter.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/./useralerts.js"></script>
        <script data-domain="ardupilot.org" defer="defer" src="https://plausible.ardupilot.org/js/script.outbound-links.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Copter
              <img src="../_static/ardupilot_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="copter-introduction.html">Copter简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-autopilots.html">选择飞控</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-GCS.html">地面站软件</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial-setup.html">首次设置</a></li>
<li class="toctree-l1"><a class="reference internal" href="flying-arducopter.html">首次飞行和调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-helicopters.html">传统直升机</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-mission-planning.html">任务规划</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-when-problems-arise.html">如果出现问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-advanced-configuration.html">高级配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-optional-hardware.html">可选硬件</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional-information.html">附加信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-user-alerts.html">用户警报</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Copter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">[copywiki destination=”plane,copter,rover,blimp”]</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="copywiki-destination-plane-copter-rover-blimp">
<span id="common-esp32-telemetry"></span><h1>[copywiki destination=”plane,copter,rover,blimp”]<a class="headerlink" href="#copywiki-destination-plane-copter-rover-blimp" title="Permalink to this heading">¶</a></h1>
</section>
<section id="esp32-wifi-telemetry">
<h1>ESP32 WiFi telemetry<a class="headerlink" href="#esp32-wifi-telemetry" title="Permalink to this heading">¶</a></h1>
<p>The ESP32 are readily available Wi-Fi modules with full TCP/IP stack and
microcontroller capability. They offer dedicated UART, SPI and I2C
interfaces. They can be used with any ArduPilot autopilot controller.</p>
<section id="dronebridge-for-esp32">
<h2>DroneBridge for ESP32<a class="headerlink" href="#dronebridge-for-esp32" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line"><strong>DroneBridge for ESP32 offers a transparent and bi-directional serial
to WiFi bridge.</strong></div>
<div class="line">Using WiFi protocol does not offer the same range as the other
DroneBridge implementations. Typical WiFi range is ~50m-200m depending
on the antennas. High gain directional antennas would offer even more
range.</div>
</div>
<img alt="DroneBridge for ESP32 connection concept" src="https://raw.githubusercontent.com/DroneBridge/ESP32/master/wiki/db_ESP32_setup.png" />
</section>
<section id="recommended-hardware">
<h2>Recommended Hardware<a class="headerlink" href="#recommended-hardware" title="Permalink to this heading">¶</a></h2>
<p>Almost every ESP32 development board is capable to run DroneBridge for
ESP32. Boards and modules with an external antenna connector are
recommended, since those will offer more range.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Most modules support 3.3V input (only), while some autopilots serial ports provide only 5V . You will need to check compatibility and step down the voltage if needed. It is not generally recommended to use the autopilot’s 3.3V supply unless you are certain it can provide enough current for the ESP32 board you are using.</p>
</div>
<p>Some examples for modules and DevKits that accept 3.3V supply:</p>
<ul class="simple">
<li><p>AZDelivery DevKit C</p></li>
<li><p><a class="reference external" href="https://www.adafruit.com/product/4335">TinyPICO - ESP32 Development Board - V2</a></p></li>
<li><p><a class="reference external" href="https://www.adafruit.com/product/3405">Adafruit HUZZAH32 – ESP32 Feather Board</a></p></li>
<li><p><a class="reference external" href="https://www.adafruit.com/product/4201">Adafruit AirLift – ESP32 WiFi Co-Processor Breakout Board</a> (requires FTDI adapter for flashing firmware)</p></li>
<li><p><a class="reference external" href="https://www.adafruit.com/product/4172">Adafruit HUZZAH32</a> (requires FTDI adapter for flashing firmware)</p></li>
<li><p>ESP32-WROOM-32UE (module only - requires custom PCB)</p></li>
<li><p>ESP32-WROOM-32E  (module only - requires custom PCB)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NodeMCU style DevKit Boards with an IPEX port for an external antenna
often also offer an onboard antenna that is activated by default. You
may need to re-solder a resistor to activate the external antenna port.</p>
</div>
</section>
<section id="downloading-and-flashing-the-firmware">
<h2>Downloading and Flashing the Firmware<a class="headerlink" href="#downloading-and-flashing-the-firmware" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://github.com/DroneBridge/ESP32/releases">Download the firmware from the GitHub repository</a> and <a class="reference external" href="https://github.com/DroneBridge/ESP32#installationflashing-using-precompiled-binaries">follow the
flashing instructions there</a>. They are always up to date.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://github.com/DroneBridge/ESP32#installationflashing-using-precompiled-binaries">Follow the flashing instructions inside the GitHub Repository.</a> The
exact parameters may differ from release to release of DroneBridge for
ESP32.</p>
</div>
<p>For convenience reasons some short instructions are given here:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/DroneBridge/ESP32/releases">Download the pre-compiled firmware binaries</a></p></li>
<li><p>Connect your DEVKit to your computer via USB/Serial bridge (most
DevKits already offer a USB port for flashing and debugging)</p></li>
<li><p>Erase the flash and flash the DroneBridge for ESP32 firmware onto
your ESP32</p>
<ul>
<li><p>Using <a class="reference external" href="https://www.espressif.com/en/support/download/other-tools">Espressif Flash Download Tool</a> (Windows only)</p></li>
<li><p>Using esp-idf/esptool (all platforms)</p></li>
</ul>
</li>
<li><p>Power Cycle the ESP32</p></li>
<li><p>Connect to the “DroneBridge for ESP32” WiFi network and configure
the firmware for your application</p></li>
</ul>
</section>
<section id="configuring-dronebridge-for-esp32">
<h2>Configuring DroneBridge for ESP32<a class="headerlink" href="#configuring-dronebridge-for-esp32" title="Permalink to this heading">¶</a></h2>
<p>You can change the default configuration via the Webinterface.
Connect to the ESP32 via WiFi and enter <code class="docutils literal notranslate"><span class="pre">dronebridge.local</span></code>, <code class="docutils literal notranslate"><span class="pre">http://dronebridge.local</span></code> or <code class="docutils literal notranslate"><span class="pre">192.168.2.1</span></code> in the address
bar of your browser.</p>
<section id="default-configuration">
<h3>Default Configuration<a class="headerlink" href="#default-configuration" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>SSID: <code class="docutils literal notranslate"><span class="pre">DroneBridge</span> <span class="pre">for</span> <span class="pre">ESP32</span></code></p></li>
<li><p>Password: <code class="docutils literal notranslate"><span class="pre">dronebridge</span></code></p></li>
<li><p>Transparent/MAVLink</p></li>
<li><p>UART baud rate <code class="docutils literal notranslate"><span class="pre">115200</span></code></p></li>
<li><p>UART TX pin <code class="docutils literal notranslate"><span class="pre">17</span></code></p></li>
<li><p>UART RX pin <code class="docutils literal notranslate"><span class="pre">16</span></code></p></li>
<li><p>Gateway IP: <code class="docutils literal notranslate"><span class="pre">192.168.2.1</span></code></p></li>
</ul>
</section>
<section id="custom-settings-webinterface">
<h3>Custom Settings &amp; Webinterface<a class="headerlink" href="#custom-settings-webinterface" title="Permalink to this heading">¶</a></h3>
<div class="line-block">
<div class="line">You can change the default configuration via the Webinterface.</div>
<div class="line">Connect to the ESP32 via WiFi and enter <code class="docutils literal notranslate"><span class="pre">dronebridge.local</span></code>,
<code class="docutils literal notranslate"><span class="pre">http://dronebridge.local</span></code> or <code class="docutils literal notranslate"><span class="pre">192.168.2.1</span></code> in the address bar of
your browser.</div>
</div>
<img alt="DroneBridge for ESP32 Webinterface" src="https://raw.githubusercontent.com/DroneBridge/ESP32/master/wiki/dbesp32_webinterface.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some settings require you to reboot the ESP32 to take effect.</p>
</div>
</section>
</section>
</section>
<section id="wiring">
<h1>Wiring<a class="headerlink" href="#wiring" title="Permalink to this heading">¶</a></h1>
<p>Wiring is very simple and mostly the same for all devices connected to
any serial port (eg TELEM1 or TELEM2) of the autopilot. This guide does not go into
detail here, but provides an outline for wiring below.</p>
<ul class="simple">
<li><p>Connect UART of ESP32 to a UART of your autopilot (e.g. TELEM
1 or TELEM 2 port). Make sure the voltage levels match! Most ESP32
DevKits can only take 3.3V!</p>
<ul>
<li><p>TX to RX</p></li>
<li><p>RX to TX</p></li>
<li><p>GND to GND</p></li>
<li><p>Stable 3.3V or 5V power supply to the ESP32 (depending on the
available inputs of your DevKit and capabilities of the autopilot)</p></li>
</ul>
</li>
<li><p>Set the autopilot port to MAVLINK 1 or 2 protocol.</p></li>
</ul>
<p>Some manufacturers of ESP32 DevKits have wrong labels for the
pins on their products. Make sure that the PINs on your board are
labeled correctly if you encounter issues.</p>
<p>Make sure to always follow the instructions of the ESP32 board manufacturer when it comes to wiring. Especially the power supply.</p>
<img alt="Example wiring of autopilot to ESP32" src="https://raw.githubusercontent.com/DroneBridge/ESP32/master/wiki/Pixhawk_wiring.png" />
</section>
<section id="ardupilot-configuration">
<h1>ArduPilot configuration<a class="headerlink" href="#ardupilot-configuration" title="Permalink to this heading">¶</a></h1>
<p>Configure the UART of the autopilot that is wired to the ESP32. The default configuration of DroneBridge is:</p>
<ul class="simple">
<li><p>Protocol: MAVLink (v1 or v2)</p></li>
<li><p>Baudrate: 115200 baud</p></li>
</ul>
<p>If connected to Serial2 these parameters should be set on the autopilot (if using another serial port, replace the “2” in the parameter name with the serial port’s number):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#serial2-protocol" title="(in Rover)"><span class="xref std std-ref">SERIAL2_PROTOCOL</span></a> = 2 (MAVLink2) or 1 (MAVLink1)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#serial2-baud" title="(in Rover)"><span class="xref std std-ref">SERIAL2_BAUD</span></a> = 115 (115200 baud)</p></li>
</ul>
<p>If you have problems connecting, it may help to set <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#brd-ser2-rtscts" title="(in Rover)"><span class="xref std std-ref">BRD_SER2_RTSCTS</span></a> = 0 to disable flow control although this is not normally necessary</p>
</section>
<section id="connecting-to-the-gcs">
<h1>Connecting to the GCS<a class="headerlink" href="#connecting-to-the-gcs" title="Permalink to this heading">¶</a></h1>
<p>The following connection options are available:</p>
<ul class="simple">
<li><p>UDP unicast on port <code class="docutils literal notranslate"><span class="pre">14550</span></code> to all connected devices.</p></li>
<li><p>TCP on port <code class="docutils literal notranslate"><span class="pre">5760</span></code></p></li>
</ul>
<p>DroneBridge for ESP32 will automatically forward all data to all
connected WiFi devices via UDP to port 14550. QGroundControl or Mission Planner should
auto-detect the connection and no further actions should be necessary.</p>
</section>
<section id="toubleshooting">
<h1>Toubleshooting<a class="headerlink" href="#toubleshooting" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p>Always erase the flash of the ESP32 before flashing a new
release/firmware</p></li>
<li><p>Check if the pins on your ESP board are labeled correctly.</p></li>
<li><p>Enter the IP address in your browsers address bar
<code class="docutils literal notranslate"><span class="pre">http://192.168.2.1</span></code>. No https supported! You may need to
disconnect from the cellular network when using a phone to be able to
access the webinterface.</p></li>
<li><p>If your network is operating in the same IP range as DB for ESP32 you
need to change the Gateway IP address in the Webinterface to
something like <code class="docutils literal notranslate"><span class="pre">192.168.5.1</span></code>.</p></li>
</ul>
</section>
<section id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this heading">¶</a></h1>
<p>DroneBridge for ESP32 offers a REST:API that allows you to read and
write configuration options. You are not limited to the options
presented by the Webinterface (e.g. baud rates). You can use the API to
set custom baud rates or to integrate the system into your own setup.</p>
<p><strong>To request the settings</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">dronebridge</span><span class="o">.</span><span class="n">local</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">settings</span><span class="o">/</span><span class="n">request</span>
</pre></div>
</div>
<p><strong>To request stats</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">dronebridge</span><span class="o">.</span><span class="n">local</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">stats</span>
</pre></div>
</div>
<p><strong>Trigger a reboot</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">dronebridge</span><span class="o">.</span><span class="n">local</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">reboot</span>
</pre></div>
</div>
<p><strong>Trigger a settings change:</strong> Send a valid JSON</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;wifi_ssid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DroneBridge ESP32&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;wifi_pass&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dronebridge&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ap_channel&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;tx_pin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">17</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;rx_pin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;telem_proto&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;baud&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">115200</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;msp_ltm_port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ltm_pp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;trans_pack_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ap_ip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.2.1&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">dronebridge</span><span class="o">.</span><span class="n">local</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">settings</span><span class="o">/</span><span class="n">change</span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ArduPilot Dev Team.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>