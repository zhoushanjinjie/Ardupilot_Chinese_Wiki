<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KDE CAN ESCs &mdash; Copter  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/common_theme_override.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_copter.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/./useralerts.js"></script>
        <script data-domain="ardupilot.org" defer="defer" src="https://plausible.ardupilot.org/js/script.outbound-links.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Copter
              <img src="../_static/ardupilot_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="copter-introduction.html">Copter简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-autopilots.html">选择飞控</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-GCS.html">地面站软件</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial-setup.html">首次设置</a></li>
<li class="toctree-l1"><a class="reference internal" href="flying-arducopter.html">首次飞行和调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-helicopters.html">传统直升机</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-mission-planning.html">任务规划</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-when-problems-arise.html">如果出现问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-advanced-configuration.html">高级配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-optional-hardware.html">可选硬件</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional-information.html">附加信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-user-alerts.html">用户警报</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Copter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">KDE CAN ESCs</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="kde-can-escs">
<span id="common-kde-can-escs"></span><h1>KDE CAN ESCs<a class="headerlink" href="#kde-can-escs" title="Permalink to this heading">¶</a></h1>
<img alt="../_images/kde-can-esc.jpg" src="../_images/kde-can-esc.jpg" />
<p>KDECAN ESCs are high-end ESCs that allow control and feedback using a custom CAN protocol</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please use Copter-4.1 (or higher), Plane-4.1 (or higher) or Rover-4.1 (or higher) with these ESCs because while earlier versions of ArduPilot supported them, there were issues with the range and motor ordering which made the setup difficult.</p>
</div>
<section id="where-to-buy">
<h2>Where To Buy<a class="headerlink" href="#where-to-buy" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.kdedirect.com/collections/uas-multi-rotor-electronics/products/kde-uas125uvc-he">KDE-UAS125UVC-HE</a> and <a class="reference external" href="https://www.kdedirect.com/collections/uas-multi-rotor-electronics/products/kde-uas85uvc">KDE-UAS85UVC</a> can be purchased from <a class="reference external" href="https://www.kdedirect.com/collections/uas-multi-rotor-electronics">KDEDirect.com</a> (other KDE ESCs may also support CAN, check the images of the ESC, those with “CAN” written on the side should work).</p></li>
<li><p><a class="reference external" href="https://www.kdedirect.com/collections/kdecan-bus-cables/products/kdecan-kit-jst-ghr-wire-kit">KDECAN Wire Kit</a> is also required</p></li>
</ul>
</section>
<section id="configuring-the-escs">
<h2>Configuring the ESCs<a class="headerlink" href="#configuring-the-escs" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://cdn.shopify.com/s/files/1/0496/8205/files/KDECAN_Pixhawk_QuickStart.pdf">KDE’s instructions for connecting and configuring with ArduPilot are here</a></p>
<ul>
<li><p>Download, install and run the <a class="reference external" href="https://www.kdedirect.com/collections/uas-multi-rotor-electronics/products/kde-dms?page=specs">KDE Direct Device Manager</a></p></li>
<li><p>Connect the first ESC to your PC with a USB cable and configure the device as shown below</p>
<a class="reference external image-reference" href="../_images/kdecan-device-manager.png"><img alt="../_images/kdecan-device-manager.png" src="../_images/kdecan-device-manager.png" style="width: 400px;" /></a>
</li>
<li><p>Repeat the configuration of all other ESCs increasing the “KDECAN ESC ID” by one each time.  It is best to label the ESC with a number that is the ESC ID - 1. Somewhat confusingly the lowest ESC IDs is 02 but this will mirror the autopilot’s SERVO1 output</p></li>
</ul>
</section>
<section id="connecting-the-escs">
<h2>Connecting the ESCs<a class="headerlink" href="#connecting-the-escs" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p>The 4-pin cable connecting the first ESC to the autopilot’s CAN1 port must have all pins swapped on one end (ideally on the end connecting to the first ESC).  Pin1 (red) should be swapped with Pin4.  Pin2 should be swapped with Pin3.  This modified cable should be used to connect the autopilot’s CAN1 port to the first ESC</p></li>
<li><p>The ESCs should be daisy chained together using the KDECAN Wire Kit.  The CAN terminator (the 4-pin connector with a black loop) should be connected to the last ESC in the chain</p>
<a class="reference external image-reference" href="../_images/kde-can-esc-cube.jpg"><img alt="../_images/kde-can-esc-cube.jpg" src="../_images/kde-can-esc-cube.jpg" style="width: 400px;" /></a>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If using a CubeBlack autopilot, the CAN1 and CAN2 labels are reversed.  These instructions assume the ESCs are connected to the CAN1 port which is labelled “CAN2” on CubeBlack autopilots</p>
</div>
</section>
<section id="configuration">
<h2>配置<a class="headerlink" href="#configuration" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Set <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#can-d1-protocol" title="(in Rover)"><span class="xref std std-ref">CAN_D1_PROTOCOL</span></a> = 8 (KDECAN)</p></li>
<li><p>Set <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#can-p1-driver" title="(in Rover)"><span class="xref std std-ref">CAN_P1_DRIVER</span></a> = 1 (First driver) to specify that the ESCs are connected to the CAN1 port</p></li>
<li><p>Set <a class="reference external" href="https://ardupilot.org/copter/docs/parameters.html#mot-pwm-min" title="(in Copter)"><span class="xref std std-ref">MOT_PWM_MIN</span></a> = 1000 and <a class="reference external" href="https://ardupilot.org/copter/docs/parameters.html#mot-pwm-max" title="(in Copter)"><span class="xref std std-ref">MOT_PWM_MAX</span></a> = 2000 so ArduPilot uses an output range that matches the ESCs input range</p></li>
<li><p>Set <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#kde-npole" title="(in Rover)"><span class="xref std std-ref">KDE_NPOLE</span></a> to the number of poles on the motor (Note it may be necessary to reboot the autopilot to cause this parameter to appear).  If you are not sure of the number, you can probably count them by looking closely into the top of the motor.  Even if set incorrectly the motors should spin normally because this number is only used to calculate the RPM reported to the ground station and stored in the onboard logs</p></li>
</ul>
</section>
<section id="logging-and-reporting">
<h2>Logging and Reporting<a class="headerlink" href="#logging-and-reporting" title="Permalink to this heading">¶</a></h2>
<p>KDECAN ESCs provide information back to the autopilot which is recorded in the autopilot’s onboard log’s ESCn messages and can be viewed in any <a class="reference internal" href="common-logs.html#common-logs"><span class="std std-ref">ArduPilot compatible log viewer</span></a>.  This information includes:</p>
<ul class="simple">
<li><p>RPM</p></li>
<li><p>Voltage</p></li>
<li><p>Current</p></li>
<li><p>ESC Temperature</p></li>
<li><p>Total Current</p></li>
</ul>
<p>The RCOU messages are also written to the onboard logs which hold the requested output level sent to the ESCs expressed as a number from 1000 (meaning stopped) to 2000 (meaning full output).</p>
<p>This information can also be viewed in real-time using a ground station.  If using the Mission Planner go to the Flight Data screen’s status tab and look for esc1_rpm.</p>
<a class="reference external image-reference" href="../_images/dshot-realtime-esc-telem-in-mp.jpg"><img alt="../_images/dshot-realtime-esc-telem-in-mp.jpg" src="../_images/dshot-realtime-esc-telem-in-mp.jpg" style="width: 450px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sending ESC data to the GCS requires using MAVLink2.  Please check the appropriate SERIALx_PROTOCOL parameter is 2 (where “x” is the serial port number used for the telemetry connection).</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ArduPilot Dev Team.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>