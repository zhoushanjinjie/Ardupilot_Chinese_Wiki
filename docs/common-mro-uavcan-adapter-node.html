<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mRobotics DroneCAN Adapter Node &mdash; Copter  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/common_theme_override.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_copter.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/./useralerts.js"></script>
        <script data-domain="ardupilot.org" defer="defer" src="https://plausible.ardupilot.org/js/script.outbound-links.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Copter
              <img src="../_static/ardupilot_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="copter-introduction.html">Copter简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-autopilots.html">选择飞控</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-GCS.html">地面站软件</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial-setup.html">首次设置</a></li>
<li class="toctree-l1"><a class="reference internal" href="flying-arducopter.html">首次飞行和调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-helicopters.html">传统直升机</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-mission-planning.html">任务规划</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-when-problems-arise.html">如果出现问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-advanced-configuration.html">高级配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-optional-hardware.html">可选硬件</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional-information.html">附加信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-user-alerts.html">用户警报</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Copter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">mRobotics DroneCAN Adapter Node</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mrobotics-dronecan-adapter-node">
<span id="common-mro-uavcan-adapter-node"></span><h1>mRobotics DroneCAN Adapter Node<a class="headerlink" href="#mrobotics-dronecan-adapter-node" title="Permalink to this heading">¶</a></h1>
<p>The mRo CAN Node is a collaborative project with ArduPilot. It began with a desire to make CAN peripherals more standard in the drone community. Compared to other boards that have open-source hardware but closed source code, mRo CAN node is completely open. The CAN Node F303 is the version 2 of mRobotics’ CAN Node, featuring more flash space.</p>
<p>With this board, you can easily utilize the ArduPilot driver library to convert ArduPilot supported GPS, I2C, and GPIO based (ie Safety Switch) peripherals to DroneCAN bus peripherals.</p>
<img alt="../_images/mRo-can-node.jpg" src="../_images/mRo-can-node.jpg" />
<p>mRo CAN Node uses open-source code, which utilizes the existing and proven ArduPilot DroneCAN driver library (see <a class="reference internal" href="common-uavcan-adapter-node.html#common-uavcan-adapter-node"><span class="std std-ref">DroneCAN Adapter Nodes</span></a> for firmware versions and capabilities). It features a  bootloader for “over CAN” firmware updates and an RTOS running Chibios.</p>
<p>The adapter’s CAN Node ID can be set manually or automatically (Not yet supported in stable ArduPilot). The hardware design is open source, so that anyone can contribute to the CAN peripheral world with a proven CAN / MCU interface.</p>
<p>As delivered, it is setup to be plug-and-play as a DroneCAN GPS/Magnetometer/LED/Airspeed by simply plugging in the 6pin GH connector from any mRo or other GPS, and connecting I2C Compasses, RGB LEDs, and/or Airspeed sensors supported by ArduPilot, as desired.</p>
<p>This adapter uses the “f303-GPS” or “f303-Universal” (default) firmware in <a class="reference external" href="https://firmware.ardupilot.org/AP_Periph">https://firmware.ardupilot.org/AP_Periph</a>. See the <a class="reference internal" href="common-uavcan-setup-advanced.html#common-uavcan-setup-advanced"><span class="std std-ref">SLCAN section of DroneCAN advanced setup</span></a> for downloading instructions, if changes are desired or updates become available.</p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">¶</a></h2>
<p>Verify the following parameters are set on your autopilot via your ground station.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#can-p1-driver" title="(in Rover)"><span class="xref std std-ref">CAN_P1_DRIVER</span></a> = 1 (assuming its on the first CAN bus of the autopilot and will be using the first driver)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#can-d1-protocol" title="(in Rover)"><span class="xref std std-ref">CAN_D1_DRIVER</span></a> = 1 (DroneCAN)(assuming its the first driver)</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#gps-type" title="(in Rover)"><span class="xref std std-ref">GPS_TYPE</span></a> = 9 (DroneCAN) or if it will be the secondary GPS, set instead</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#gps-type2" title="(in Rover)"><span class="xref std std-ref">GPS_TYPE2</span></a> = 9 (DroneCAN)</p></li>
<li><p>Reboot</p></li>
</ul>
<p>Make sure the DroneCAN compass driver is not disabled. (<a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#compass-typemask" title="(in Rover)"><span class="xref std std-ref">COMPASS_TYPEMASK</span></a> bit 9 should not be set).</p>
<p>If your controller has multiple compasses attached already, you may want to set the attached compass as a higher priority than others, if it has better precision or performance.</p>
<p>To enable an attached I2C RGB LED set:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ntf-led-types" title="(in Rover)"><span class="xref std std-ref">NTF_LED_TYPES</span></a> bit 5 should be set</p></li>
</ul>
<p>If you want to enable an attached I2C airspeed sensor, set:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#arspd-type" title="(in Rover)"><span class="xref std std-ref">ARSPD_TYPE</span></a> = 8 (DroneCAN)</p></li>
</ul>
<p>Then you must access your Adapter’s CAN parameters to select Airspeed and LED type being attached to the adapter. Using Mission Planner (or <a class="reference internal" href="common-uavcan-gui.html#common-uavcan-gui"><span class="std std-ref">DroneCAN GUI</span></a>), go to the menu SETUP/Optional Hardware/DroneCAN/SLCan Mode CAN1/Parameters. Once the CAN Adapters parameters appear, change the following (this changes them inside the DroneCAN adapter, NOT the autopilot, allowing the adapter to use the correct driver and convert the information to DroneCAN airspeed format):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#arspd-type" title="(in Rover)"><span class="xref std std-ref">ARSPD_TYPE</span></a> = to match your sensor type: 3,for an I2C-MS5525; 1 for an MS4525DO, etc.</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#arspd-use" title="(in Rover)"><span class="xref std std-ref">ARSPD_USE</span></a> =  1</p></li>
<li><p><a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#arspd-bus" title="(in Rover)"><span class="xref std std-ref">ARSPD_BUS</span></a> =  0</p></li>
</ul>
<p>For the LED, set its <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#ntf-led-types" title="(in Rover)"><span class="xref std std-ref">NTF_LED_TYPES</span></a> appropriately for the attached LED.</p>
<p>Then reboot.</p>
</section>
<section id="where-to-buy">
<h2>Where to buy<a class="headerlink" href="#where-to-buy" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://store.mrobotics.io/product-p/mro10042a.htm">mRobotics</a></p>
</section>
<section id="schematics">
<h2>Schematics<a class="headerlink" href="#schematics" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://github.com/ArduPilot/Schematics/blob/master/mRobotics/mRo_CANnode_V1_R1.pdf">Schematic</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>F103 is replaced with F303 microprocessor</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ArduPilot Dev Team.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>