<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GPS Failsafe and Glitch Protection &mdash; Copter  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/common_theme_override.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_copter.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/./useralerts.js"></script>
        <script data-domain="ardupilot.org" defer="defer" src="https://plausible.ardupilot.org/js/script.outbound-links.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dead Reckoning Failsafe" href="deadreckoning-failsafe.html" />
    <link rel="prev" title="EKF Failsafe" href="ekf-inav-failsafe.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Copter
              <img src="../_static/ardupilot_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="copter-introduction.html">Copter简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-autopilots.html">选择飞控</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-GCS.html">地面站软件</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="initial-setup.html">首次设置</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="common-install-gcs.html">安装地面站软件</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot-assembly-instructions.html">飞控系统安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-loading-firmware-onto-pixhawk.html">将固件加载到有ArduPilot固件的板子</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-loading-firmware-onto-chibios-only-boards.html">将固件加载到没有ArduPilot固件的板子</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-connect-mission-planner-autopilot.html">连接Mission Planner和飞控</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="configuring-hardware.html">配置</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="common-basic-operation.html">基本系统概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="frame-type-configuration.html">机型配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="connect-escs-and-motors.html">电机编号和方向</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-radio-control-calibration.html">RC校准</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-accelerometer-calibration.html">加速度计校准</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-compass-calibration-in-mission-planner.html">指南针校准</a></li>
<li class="toctree-l3"><a class="reference internal" href="common-rc-transmitter-flight-mode-configuration.html">遥控器飞行模式设置</a></li>
<li class="toctree-l3"><a class="reference internal" href="esc-calibration.html">电调校准</a></li>
<li class="toctree-l3"><a class="reference internal" href="set-motor-range.html">配置电机范围（可选）</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="failsafe-landing-page.html">故障保护机制</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="radio-failsafe.html">Radio Failsafe</a></li>
<li class="toctree-l4"><a class="reference internal" href="failsafe-battery.html">Battery Failsafe</a></li>
<li class="toctree-l4"><a class="reference internal" href="gcs-failsafe.html">GCS Failsafe</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="ekf-inav-failsafe.html">EKF Failsafe</a></li>
<li class="toctree-l4"><a class="reference internal" href="deadreckoning-failsafe.html">Dead Reckoning Failsafe</a></li>
<li class="toctree-l4"><a class="reference internal" href="vibration-failsafe.html">Vibration Failsafe</a></li>
<li class="toctree-l4"><a class="reference internal" href="tkoff-rpm-min.html">Dead Motor Takeoff Prevention</a></li>
<li class="toctree-l4"><a class="reference internal" href="terrain-following.html">Terrain Data Loss Failsafe (see section on loss of terrain data induced RTL)</a></li>
<li class="toctree-l4"><a class="reference internal" href="crash_check.html">Crash Check</a></li>
<li class="toctree-l4"><a class="reference internal" href="common-parachute.html">Parachute</a></li>
<li class="toctree-l4"><a class="reference internal" href="common-watchdog.html">Independent Watchdog</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flight-modes.html">飞行模式</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flying-arducopter.html">首次飞行和调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-helicopters.html">传统直升机</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-mission-planning.html">任务规划</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-when-problems-arise.html">如果出现问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-advanced-configuration.html">高级配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-optional-hardware.html">可选硬件</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional-information.html">附加信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-user-alerts.html">用户警报</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Copter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="initial-setup.html">首次设置</a></li>
          <li class="breadcrumb-item"><a href="configuring-hardware.html">必要硬件配置</a></li>
          <li class="breadcrumb-item"><a href="failsafe-landing-page.html">Failsafe</a></li>
          <li class="breadcrumb-item"><a href="ekf-inav-failsafe.html">EKF Failsafe</a></li>
      <li class="breadcrumb-item active">GPS Failsafe and Glitch Protection</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gps-failsafe-and-glitch-protection">
<span id="gps-failsafe-glitch-protection"></span><h1>GPS Failsafe and Glitch Protection<a class="headerlink" href="#gps-failsafe-and-glitch-protection" title="Permalink to this heading">¶</a></h1>
<p>This article describes the glitch protection mechanisms used to trigger
GPS Failsafe.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>GPS Systems can occasionally drop the signal or provide significantly
inaccurate position information (aka “glitches”). While errors are more
likely in conditions where the GPS signal can bounce off multiple paths
before reaching the receiver (multipathing), errors can occasionally
occur even with clear sky.</p>
<p>A <em>GPS failsafe</em> event will occur if GPS 3D
lock or the position “Glitches” for at least 5 seconds while Copter is
in a mode that requires the GPS (RTL, Auto, Loiter, Circle, Position,
Guided or Drift).  The GPS failsafe response can be set to Land or
switch to AltHold mode so that you can retake
manual control.</p>
<p>Without GPS updates, the inertial sensors allow approximately 10 seconds
of accurate position information but after this the horizontal position
drift becomes so large that the horizontal position cannot be maintained
at all.  At this point if you still have RC radio control it is
recommended to take back control using Stabilize, Acro or AltHold as
soon as possible.</p>
</section>
<section id="glitch-protection-default">
<h2>Glitch Protection - Default<a class="headerlink" href="#glitch-protection-default" title="Permalink to this heading">¶</a></h2>
<p>GPS glitch protection is provided which can help alert the
pilot to a bad GPS position, trigger a failsafe and reduce the incidents
of fly-aways.  Glitches are detected by comparing the each new position
update received from the GPS with a position projected out from the
previous update’s position and velocity.</p>
<a class="reference external image-reference" href="../_images/GPSGlitchDetection.jpg"><img alt="../_images/GPSGlitchDetection.jpg" src="../_images/GPSGlitchDetection.jpg" /></a>
<p>The new position is accepted as “good” if:</p>
<ol class="arabic simple">
<li><p>the two positions are within the <code class="docutils literal notranslate"><span class="pre">GPSGLITCH_RADIUS</span></code> (defaults to
5m).</p></li>
<li><p>the new position is within a radius that is 10m/s/s
(<code class="docutils literal notranslate"><span class="pre">GPSGLITCH_ACCEL</span></code>) * dt * dt.  Where “dt” is the time difference
between the two samples.</p></li>
</ol>
<p>During a glitch, “Bad Position” will be written on the ground station’s
HUD</p>
</section>
<section id="glitch-protection-ekf">
<h2>Glitch Protection - EKF<a class="headerlink" href="#glitch-protection-ekf" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="common-apm-navigation-extended-kalman-filter-overview.html#common-apm-navigation-extended-kalman-filter-overview"><span class="std std-ref">ArduPilot Extended Kalman Filter (EKF)</span></a>)provided glitch protection.</p>
<p>Glitch protection using the EKF works as follows:</p>
<ol class="arabic simple">
<li><p>When new GPS position measurements are received, they are compared to
a position predicted using IMU measurements.</p></li>
<li><p>If the difference exceeds a statistical confidence level set by
<code class="docutils literal notranslate"><span class="pre">EKF_POS_GATE</span></code>, then the measurement won’t be used.</p></li>
<li><p>While GPS measurements aren’t being used, a circle defined by an
uncertainty radius grows around the predicted position. The rate at
which this radius grows is controlled by <code class="docutils literal notranslate"><span class="pre">EKF_GLITCH_ACCEL</span></code>. This
is similar to the circle defined by <code class="docutils literal notranslate"><span class="pre">GPSGLITCH_ACCEL</span></code>, the
difference being it is centered around the trajectory predicted by
the IMU rather than previous GPS measurements. Because this allows
for deviations in trajectory due to maneuvers, the default value for
<code class="docutils literal notranslate"><span class="pre">EKF_GLTCH_ACCEL</span></code> is smaller at 1.5 m/s/s. The acceleration growth
of the circle is also increased when the vehicle is accelerating or
turning to allow for the increase in IMU errors during maneuvers.</p></li>
<li><p>If subsequent GPS measurements fall inside the circle, they will be
accepted and the circle is reset back to the minimum radius
controlled by <code class="docutils literal notranslate"><span class="pre">EKF_POS_GATE</span></code>.</p></li>
<li><p>If the GPS glitch is large enough and lasts long enough, the GPS
measurements will continue to be rejected until the circle radius
exceeds a value set by <code class="docutils literal notranslate"><span class="pre">EKF_GLITCH_RAD</span></code>. When this happens, an
offset is applied to the GPS position so that it matches the
estimated vehicle position and the GPS positions are used again. The
GPS offset is then reduced to zero at 1 m/s. This means that large
long duration glitches will cause the vehicle to drift at a 1 m/s
rate. This is slow enough to give the operator plenty of time to
react.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ekf-inav-failsafe.html" class="btn btn-neutral float-left" title="EKF Failsafe" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="deadreckoning-failsafe.html" class="btn btn-neutral float-right" title="Dead Reckoning Failsafe" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ArduPilot Dev Team.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>