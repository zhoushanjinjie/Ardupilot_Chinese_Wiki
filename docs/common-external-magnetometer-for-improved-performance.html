<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Archived: External Compass &mdash; Copter  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/common_theme_override.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_copter.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/./useralerts.js"></script>
        <script data-domain="ardupilot.org" defer="defer" src="https://plausible.ardupilot.org/js/script.outbound-links.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Copter
              <img src="../_static/ardupilot_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="copter-introduction.html">Copter简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-autopilots.html">选择飞控</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-GCS.html">地面站软件</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial-setup.html">首次设置</a></li>
<li class="toctree-l1"><a class="reference internal" href="flying-arducopter.html">首次飞行和调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-helicopters.html">传统直升机</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-mission-planning.html">任务规划</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-when-problems-arise.html">如果出现问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-advanced-configuration.html">高级配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-optional-hardware.html">可选硬件</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional-information.html">附加信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-user-alerts.html">用户警报</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Copter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Archived: External Compass</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="archived-external-compass">
<span id="common-external-magnetometer-for-improved-performance"></span><h1>Archived: External Compass<a class="headerlink" href="#archived-external-compass" title="Permalink to this heading">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>ARCHIVED ARTICLE</strong></p>
<p>Almost everyone has moved to <a class="reference internal" href="common-installing-3dr-ublox-gps-compass-module.html#common-installing-3dr-ublox-gps-compass-module"><span class="std std-ref">GPS+compass module</span></a>.</p>
</div>
<p>This page covers the installation of a stand-alone external compass
( hmc5883l-triple-axis-magnetometer).  You may alternatively use the
combined <a class="reference internal" href="common-installing-3dr-ublox-gps-compass-module.html#common-installing-3dr-ublox-gps-compass-module"><span class="std std-ref">GPS+Compass module</span></a>.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>The 3DR external compass should only be used with the APM series of
autopilots, its 5 volt signal output is not compatible with Pixhawk which require 3.3 volts.
For the Pixhawk use the <a class="reference internal" href="common-installing-3dr-ublox-gps-compass-module.html#common-installing-3dr-ublox-gps-compass-module"><span class="std std-ref">3DR combination GPS / Magnetometer module</span></a>.</p>
<a class="reference external image-reference" href="../_images/Magnetometer1.jpg"><img alt="../_images/Magnetometer1.jpg" src="../_images/Magnetometer1.jpg" /></a>
<ol class="arabic simple">
<li><p>If you’re having trouble with magnetic noise affecting your
compass on-board the APM 2.5 board, you may want to switch to an
external compass that you can mount further away from noise sources
such as motors and your power wiring and batteries.</p></li>
<li><p>Magnetometers are most strongly influenced by DC magnetic fields and
your batteries and the ESC primary power wiring are the worst
offenders.</p></li>
<li><p>Your primary goal is to distance the magnetometer from batteries, DC
battery wiring and the wiring to your ESCs.</p></li>
<li><p>It will also help to twist the battery and ESC power and ground wires
wires together where possible.</p></li>
<li><p>It is also important to keep the magnetometer distanced from magnetic
metallic objects (use nylon or non magnetic stainless screws and
hardware in its vicinity and use aluminum or nylon standoffs.).</p></li>
</ol>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>If the Magnetometer board is mounted in its forward facing direction
(Drone logo on the tab facing forward and in the opposite direction
of the Y arrow) the (<a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#compass-orient" title="(in Rover)"><span class="xref std std-ref">COMPASS_ORIENT</span></a> ) parameter will need to be set
to (Normal) or “0”.</p>
<ul>
<li><p>If you have the Y arrow pointing to the front (Drone on tab
pointing to the back), set (<a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#compass-orient" title="(in Rover)"><span class="xref std std-ref">COMPASS_ORIENT</span></a> ) to (Yaw 180).</p></li>
</ul>
</li>
<li><p>You will need to set the Magnetometer Orientation Parameter
(<a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#compass-orient" title="(in Rover)"><span class="xref std std-ref">COMPASS_ORIENT</span></a> ) in the Mission Planner Advanced Parameter List
correctly to accommodate the Magnetometer’s orientation.</p></li>
<li><p>If the Autopilot board is used in an alternate orientation
(or upside down), the (<a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#compass-orient" title="(in Rover)"><span class="xref std std-ref">COMPASS_ORIENT</span></a> ) parameter will need to also
be adjusted to accommodate the Autopilot boards orientation
as well as its own. (They are additive).</p></li>
<li><p>It can be confusing, but all orientations in 45 degree increments and
even upside down can be accommodated.</p>
<ol class="arabic simple">
<li><p>This <strong>Quick Setup Procedure</strong> will always work and allow you to
set up your compass even if you use a non-3DR magnetometer.</p></li>
<li><p>Set the (<a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#compass-orient" title="(in Rover)"><span class="xref std std-ref">COMPASS_ORIENT</span></a> ) <strong>Yaw</strong> parameter so the direction your
airframe is currently pointing agrees with the <strong>HUD</strong> in Mission
Planner.</p></li>
<li><p>Now turn your air frame right or left and if the compass correctly
follows the direction it is pointed you are done.</p></li>
<li><p>If the compass turned in the opposite direction of your airframe
set (<a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#compass-orient" title="(in Rover)"><span class="xref std std-ref">COMPASS_ORIENT</span></a> ) <strong>Roll</strong> to <strong>180</strong> (flips the compass
over).</p></li>
<li><p>If you need to set <strong>Roll</strong> to <strong>180</strong> (<a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#compass-orient" title="(in Rover)"><span class="xref std std-ref">COMPASS_ORIENT</span></a> ) will also
need to include the <strong>Yaw</strong> from <strong>B.</strong> above <strong>(Example: Yaw 180
Roll 180)</strong>.</p></li>
</ol>
</li>
</ul>
</section>
<section id="connecting-to-the-apm-2-5">
<h2>Connecting to the APM 2.5<a class="headerlink" href="#connecting-to-the-apm-2-5" title="Permalink to this heading">¶</a></h2>
<p><strong>1.</strong> Purchase an <em>HMC5883L magnetometer breakout board</em>. Ensure the
magnetometer board is set to use 3.3 volts (the APM 2.5’s I2C port uses
3.3 volts, not 5 volts). The magnetometer board is supplied with the 5
volt pad solder bridged and must be modified as shown below.</p>
<a class="reference external image-reference" href="../_images/MagnetometerJumper3v3.jpg"><img alt="../_images/MagnetometerJumper3v3.jpg" src="../_images/MagnetometerJumper3v3.jpg" /></a>
<p><strong>2.</strong> Looking at the below picture, cut the jumper trace in the middle
of the APM 2.5 board. This disables the SDA line to the board’s internal
magnetometer, rendering it inert.</p>
<a class="reference external image-reference" href="../_images/APMCompassModification.jpg"><img alt="../_images/APMCompassModification.jpg" src="../_images/APMCompassModification.jpg" /></a>
<p><strong>3.</strong> The APM 2.5 I2C connector needs a 4 pin DF13 connector. Cut off
one and and strip and tin the four wires.</p>
<p><strong>4.</strong> Connect the DF13’s 4 wires to the compass breakout board. Note
that the wires will not be one to one. Pin 1 on the DF13 connector will
not go to pin 1 of the compass board. The standard 3DR cable has one red
wire and three black wires. Substitute your wire colors accordingly.
Solder the wires as follows:</p>
<ul class="simple">
<li><p><strong>Red wire</strong> on end of connector (+3.3v) goes to the VCC (or +3.3v)
pad on the compass board (see labels on board for location). This is
the wire closest to the interior on the APM 2.5 board.</p></li>
<li><p><strong>Wire next to red wire</strong> (SCL) goes to the SCL pad on the compass
board.</p></li>
<li><p><strong>Wire next to wire next to red wire</strong> (SDA) goes to the SDA pad on
compass board.</p></li>
<li><p><strong>Black wire on end of connector</strong> (ground) goes to ground pad on
compass board. This is the wire closest to the edge of the APM 2.5
board.</p></li>
</ul>
<p><strong>5. The photo below depicts a MultiCopter with the Magnetometer mounted
on top away from the DC magnetic fields generated by the Power Wiring
and ESCs.</strong></p>
<ul class="simple">
<li><p>Double-sided foam tape works well for this.</p></li>
<li><p>The GPS modules antenna must be on top.</p></li>
<li><p>In the picture below, we’ve mounted the board “components up with
pins forward”.</p></li>
<li><p>Autopilot board orientation and magnetometer orientation must
be used to calculate the <a class="reference external" href="https://ardupilot.org/rover/docs/parameters.html#compass-orient" title="(in Rover)"><span class="xref std std-ref">COMPASS_ORIENT</span></a> parameter.</p></li>
</ul>
<a class="reference external image-reference" href="../_images/Quad_Top_View.jpg"><img alt="../_images/Quad_Top_View.jpg" src="../_images/Quad_Top_View.jpg" /></a>
</section>
<section id="connecting-to-the-apm2-0">
<h2>Connecting to the APM2.0<a class="headerlink" href="#connecting-to-the-apm2-0" title="Permalink to this heading">¶</a></h2>
<p>The APM 2.0 requires the cutting of the SDA trace on the top of the GPS
/ Magnetometer / SDA carrier board.</p>
<a class="reference external image-reference" href="../_images/apm2_mag_cut_2.jpg"><img alt="../_images/apm2_mag_cut_2.jpg" src="../_images/apm2_mag_cut_2.jpg" /></a>
<p>Also, leave the pads on the external Magnetometer board bridged for 3.3
volts rather than switching it to 5 volts..</p>
<p>The remainder of the procedure is exactly as explained for the APM 2.5.</p>
</section>
<section id="setup-through-the-mission-planner">
<h2>Setup through the Mission Planner<a class="headerlink" href="#setup-through-the-mission-planner" title="Permalink to this heading">¶</a></h2>
<a class="reference external image-reference" href="../_images/CompassScreen.jpg"><img alt="../_images/CompassScreen.jpg" src="../_images/CompassScreen.jpg" /></a>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ArduPilot Dev Team.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>